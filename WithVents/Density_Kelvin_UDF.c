
#include "udf.h"

DEFINE_PROPERTY(cell_density, cell, thread)
{
    double temperature;
    double density;
    temperature = C_T(cell, thread); /* Temperature in Fluent is already in Kelvin */

    double data[][2] = {
        {308.55084999999997, 2819.886000},
        {318.79087, 2818.046000},
        {329.03085999999996, 2816.190000},
        {339.27085, 2814.318000},
        {349.51086999999995, 2812.431000},
        {359.75086, 2810.528000},
        {369.99084999999997, 2808.609000},
        {380.23089999999996, 2806.674000},
        {390.4709, 2804.724000},
        {400.7109, 2802.759000},
        {410.9509, 2800.778000},
        {421.19089999999994, 2798.782000},
        {431.43089999999995, 2796.770000},
        {441.67089999999996, 2794.743000},
        {451.91089999999997, 2792.701000},
        {462.1509, 2790.644000},
        {472.3909, 2788.572000},
        {482.6309, 2786.484000},
        {492.8709, 2784.382000},
        {503.1108, 2782.264000},
        {513.3508999999999, 2780.132000},
        {523.5908999999999, 2777.984000},
        {533.8308, 2775.822000},
        {544.0708, 2773.645000},
        {554.3109, 2771.454000},
        {564.5509, 2769.247000},
        {574.7909, 2767.026000},
        {585.0309, 2764.791000},
        {595.2708, 2762.541000},
        {605.5108, 2760.276000},
        {615.7508, 2757.998000},
        {625.9909, 2755.704000},
        {636.2309, 2753.397000},
        {646.4709, 2751.075000},
        {656.7109, 2748.740000},
        {666.9508, 2746.389000},
        {677.1908, 2744.025000},
        {687.4309, 2741.648000},
        {697.6709, 2732.397000},
        {707.8308, 2742.938000},
        {718.0708, 2739.687000},
        {727.6709, 2736.517000},
        {737.9009, 2732.868000},
        {748.1407999999999, 2728.652000},
        {758.3807999999999, 2723.104000},
        {768.6047, 2713.125000},
        {774.9408, 2707.073000},
        {785.1809, 2701.033000},
        {794.7708, 2692.511000},
        {800.2809, 2686.424000},
        {809.8808, 2679.229000},
        {816.9209, 2672.286000},
        {821.4009, 2666.513000},
        {825.2409, 2660.122000},
        {827.8009, 2654.694000},
        {830.3509, 2647.858000},
        {831.7309, 2643.699000},
        {833.0108, 2639.232000},
        {834.2909, 2634.012000},
        {835.5606, 2627.873000},
        {836.0309, 2625.346000},
        {839.0108, 2618.047000},
        {844.1308, 2609.474000},
        {849.2508, 2599.928000},
        {853.0909, 2592.008000},
        {856.9309, 2583.316000},
        {858.9009, 2578.649000},
        {869.0609, 2574.878000},
        {879.3009, 2570.900000},
        {889.5409, 2566.718000},
        {899.7809, 2562.302000},
        {910.0208, 2557.623000},
        {918.1209, 2553.779000},
        {928.3609, 2548.714000},
        {938.6009, 2543.213000},
        {948.8409, 2537.258000},
        {959.0640999999999, 2530.831000},
        {966.9209, 2528.514000},
        {977.1609, 2525.496000},
        {987.4009, 2522.481000},
        {997.6408, 2519.468000},
        {1007.8809, 2516.458000},
        {1018.1209, 2513.452000},
        {1028.3609000000001, 2510.451000},
        {1038.6009, 2507.454000},
        {1048.8409000000001, 2504.462000},
        {1059.0809, 2501.476000},
        {1069.3209, 2498.496000},
        {1079.5609, 2495.524000},
        {1089.8009, 2492.561000},
        {1100.0409, 2489.606000},
        {1107.8109, 2487.373000},
        {1118.0509, 2484.443000},
        {1128.2909, 2481.526000},
        {1138.5309, 2478.622000},
        {1148.7608, 2475.737000},

    };
    int num_points = sizeof(data) / sizeof(data[0]);

    /* Interpolation logic (simple linear interpolation) */
    int i;
    for (i = 0; i < num_points - 1; ++i) {
        if (temperature >= data[i][0] && temperature <= data[i+1][0]) {
            density = data[i][1] + (data[i+1][1] - data[i][1]) * (temperature - data[i][0]) / (data[i+1][0] - data[i][0]);
            return density;
        }
    }

    /* Default value if outside the data range */
    return data[0][1]; 
}

